<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Batch Schnorr Proof Verification</title>
    <script>
        async function submitBatchVerification(event) {
            event.preventDefault(); // Prevent the default form submission

            // Get employer emails and student DIDs from the form
            const emails = document.getElementById("emails").value.trim().split(",");
            const student_dids = document.getElementById("student_dids").value.trim().split(",");

            if (emails.length !== student_dids.length) {
                document.getElementById("result").innerText = "Error: The number of emails and student DIDs must match!";
                return;
            }

            // Create a list of students with emails and student DIDs
            const students = emails.map((email, index) => {
                return {
                    email: email.trim().toLowerCase(),
                    student_did: student_dids[index].trim()
                };
            });

            // Send a POST request with the students' data to the Flask app
            const response = await fetch('/batch_verify', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ students: students })
            });

            const result = await response.json();
            document.getElementById("result").innerText = result.message + 
                (result.verification_time ? " Verification Time: " + result.verification_time + " seconds" : "");
        }
    </script>
</head>
<body>

<h2>Batch Schnorr Proof Verification</h2>

<form id="batchVerifyForm" onsubmit="submitBatchVerification(event)">
    <label for="emails">Enter Employer Emails (Comma-separated):</label><br>
    <input type="text" id="emails" name="emails" placeholder="employer1@example.com, employer2@example.com" required><br><br>

    <label for="student_dids">Enter Student DIDs (Comma-separated):</label><br>
    <input type="text" id="student_dids" name="student_dids" placeholder="0x123..., 0x456..." required><br><br>

    <button type="submit">Submit Batch Verification</button>
</form>

<p id="result"></p>

</body>
</html>
